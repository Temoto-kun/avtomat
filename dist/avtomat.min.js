(function(e){e.Avtomat=e.Avtomat||{StateMachine:function(e,t){function u(e,t,r){n[e].transitions[t]=r}function a(e,t,i){if(n[e]===undefined){if(o==r)p(e);n[e]=f();if(e!=r){l(e,t);for(var s in i){u(e,s,i[s])}}}}function f(){return{"final":false,transitions:[]}}function l(e,t){if(e!=r)n[e].final=t}function c(){s=[o];h("");return s}function h(e){var t=s,o=[],u=false;while(t.length>0){var a=t.shift();var f=n[a].transitions[e]||(e==i?a:r);var l;if(f instanceof Array)l=f;else l=[f];for(var c=0;c<l.length;c++){var p=false;for(var d=0,v=o.length;d<v;d++)p=p||o[d]==l[c];if(!p&&l[c]!=r)o.push(l[c])}if(e==i&&f==r)u=false}s=o;if(o.length>0){for(var m in o){if(n[o[m]].transitions[i]!==undefined){u=true;break}}if(u)h(i)}return s}function p(e){o=e}function d(){return s}function v(){for(var e in s){if(n[s[e]].final)return true}return false}var n=[],r=null,i="",s=[r],o=t||r;(function(e,t){a(r,false,[]);if(e!==undefined)for(var n in e){a(n,e[n].final,e[n].transitions)}if(t!==undefined)p(t);c()})(e,t);return{reset:function(){return c()},input:function(e){return h(e)},state:function(){return d()},accepted:function(){return v()},nullState:function(){return d().length==0}}}}})(window)